{"paragraphs":[{"text":"%pyspark\n\nprint \"Hello!\"\n","dateUpdated":"2016-09-12T10:12:16+0900","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1473642707514_-1786896198","id":"20160912-101147_129171156","result":{"code":"SUCCESS","type":"TEXT","msg":"Hello!\n"},"dateCreated":"2016-09-12T10:11:47+0900","dateStarted":"2016-09-12T10:12:16+0900","dateFinished":"2016-09-12T10:12:33+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:148"},{"text":"%pyspark\n\nimport os\n\ntargets = sc.wholeTextFiles(\"/home/rytoa/blog/transformed\")\n\nfiles = targets.map(lambda target: (os.path.basename(target[0]).split(\"_\")[0], target[1].split(u\"\\n\")))\ntmp = files.flatMapValues(lambda x: x)\ntmp = tmp.filter(lambda x: x[1] not in [u\"EOS\", u\"\"])\ntmp = tmp.map(lambda x: ([x[0],] + x[1].split(\"\\t\")))\nwords = tmp.map(lambda x: (x[1], (x[0], x[2],))).filter(lambda x: u\"固有名詞\" in x[1][1].split(\",\") and u\"一般\" in x[1][1].split(\",\"))\nwordsForCount = words.map(lambda x: ((x[0], x[1][0]), 1))\n\n\ncountsByDay = wordsForCount.reduceByKey(lambda a, b: a+b)\ncountsByYear = wordsForCount.map(lambda x: ((x[0][0], x[0][1].split(\"-\")[0]), x[1])).reduceByKey(lambda a, b: a+b)\n\ncountsByYear = countsByYear.groupBy(lambda x: x[0][1]).sortByKey(ascending=False).collect()\nfor count in countsByYear:\n    year = count[0]\n    words = list(count[1])\n    sortedWordsTopX = sorted(words, key=lambda w: w[1], reverse=True)[0:10]\n    print \"[%s]\" % year\n    for word in sortedWordsTopX:\n        print(\"%s : %s\" % (word[0][0], word[1]))","dateUpdated":"2016-09-12T17:33:36+0900","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1473642736365_1225364238","id":"20160912-101216_1292538818","result":{"code":"SUCCESS","type":"TEXT","msg":"[2015]\nAWS : 71\nAmazon : 63\naws : 61\nS3 : 46\nLinux : 44\nEC2 : 32\n脆弱性 : 27\nCVE : 27\nDATE : 27\nアップロード : 24\n[2014]\nAmazon : 30\nDocker : 20\nAWS : 20\nnull : 17\nデータウェアハウス : 17\nデプロイ : 13\nid : 10\ntalk : 9\nEC2 : 9\nBeans : 9\n[2013]\nnode.js : 46\ntransaction : 39\nvoid : 39\nブラウザ : 34\nEngine : 34\nUI : 30\nString : 25\ntitle : 24\nkey : 24\nアプリ : 23\n[2012]\nscript : 50\nhtml : 50\nAPI : 40\ntype : 39\nid : 38\nbody : 37\nアプリ : 36\nhead : 36\ntitle : 34\ndiv : 32\n[2011]\nandroid : 148\nmx : 90\n.s : 88\nid : 75\nvoid : 73\nfx : 68\nhttp:// : 64\nAWS : 60\nbe. : 54\nname : 53\n"},"dateCreated":"2016-09-12T10:12:16+0900","dateStarted":"2016-09-12T17:33:36+0900","dateFinished":"2016-09-12T17:33:37+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:149"},{"text":"","dateUpdated":"2016-09-12T18:05:38+0900","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1473642989703_-1755333108","id":"20160912-101629_1570082165","dateCreated":"2016-09-12T10:16:29+0900","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:150"}],"name":"words","id":"2BVEZDG2M","angularObjects":{"2BX7H73AJ:shared_process":[],"2BWBHAKNR:shared_process":[],"2BX2Z2EFA:shared_process":[],"2BUJ1NXPA:shared_process":[],"2BX8HZ4RA:shared_process":[],"2BY6DUAJZ:shared_process":[],"2BY99F1HB:shared_process":[],"2BXWGJYTU:shared_process":[],"2BW5V25CP:shared_process":[],"2BXJJGHPG:shared_process":[],"2BV7N89Z9:shared_process":[],"2BXMUYSNV:shared_process":[],"2BXYKGY7Z:shared_process":[],"2BX4U9VTB:shared_process":[],"2BWY9UGDW:shared_process":[],"2BYDHWAHK:shared_process":[],"2BWXNWQZC:shared_process":[],"2BX2QQ67D:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}